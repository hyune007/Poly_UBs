<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>ƒêƒÉng k√Ω - Tech Store</title>
    <link rel="stylesheet" href="/css/general.css">
    <link rel="stylesheet" href="/css/auth/register.css">
    <!-- Google Auth -->
    <!-- Firebase core -->
    <script src="https://www.gstatic.com/firebasejs/10.14.1/firebase-app-compat.js"></script>
    <!-- Firebase Auth -->
    <script src="https://www.gstatic.com/firebasejs/10.14.1/firebase-auth-compat.js"></script>
    <style>

    </style>
</head>
<body>

<!-- üß† N·ªÅn m·∫°ch ƒëi·ªán t·ª≠ -->
<div class="circuit-background"></div>

<!-- ‚¨ÖÔ∏è N√∫t quay l·∫°i -->
<a href="/login" class="back-btn">
    ‚Üê <span>Quay l·∫°i ƒëƒÉng nh·∫≠p</span>
</a>

<!-- Code cho ƒëƒÉng nh·∫≠p b·∫±ng google -->
<script>
    const firebaseConfig = {
        apiKey: "AIzaSyCL7fPCKVUMPpLnQjAfIQi7KavT8pEdBJw",
        authDomain: "assignment-ts00705.firebaseapp.com",
        projectId: "assignment-ts00705",
        storageBucket: "assignment-ts00705.appspot.com",
        messagingSenderId: "1000313447098",
        appId: "1:1000313447098:web:c1264a8b461d29473b9883",
        measurementId: "G-3GTN9GLB3J"
    };

    firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();

    document.getElementById('googleSignIn').addEventListener('click', async () => {
        const provider = new firebase.auth.GoogleAuthProvider();
        try {
            const result = await auth.signInWithPopup(provider);
            const user = result.user;
            const idToken = await user.getIdToken();

            // POST idToken to backend to create session
            const res = await fetch('/sessionLogin', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ idToken })
            });

            if (res.ok) {
                // Redirect to home page where Thymeleaf will show info from session
                window.location.href = '/';
            } else {
                const txt = await res.text();
                alert('Login failed: ' + txt);
            }
        } catch (err) {
            console.error(err);
            alert('Sign-in error: ' + err.message);
        }
    });
</script>

<!-- ‚òÅÔ∏è Sinh nhi·ªÅu m√¢y -->
<script>
    function createCloud(top, size, duration, opacity) {
        const cloud = document.createElement("div");
        cloud.classList.add("cloud");
        cloud.style.top = top + "%";
        cloud.style.left = -size + "px";
        cloud.style.width = size + "px";
        cloud.style.height = size / 3 + "px";
        cloud.style.opacity = opacity;
        cloud.style.animationDuration = duration + "s";
        document.body.appendChild(cloud);
    }

    for (let i = 0; i < 10; i++) {
        createCloud(
            Math.random() * 70,
            150 + Math.random() * 250,
            60 + Math.random() * 50,
            0.3 + Math.random() * 0.4
        );
    }
</script>

<!-- üåê Icon c√¥ng ngh·ªá -->
<img src="https://cdn-icons-png.flaticon.com/512/888/888879.png" class="tech-icon" style="top:10%; left:5%;">
<img src="https://cdn-icons-png.flaticon.com/512/1006/1006363.png" class="tech-icon" style="bottom:15%; right:10%;">
<img src="https://cdn-icons-png.flaticon.com/512/4248/4248443.png" class="tech-icon" style="top:20%; right:15%;">
<img src="https://cdn-icons-png.flaticon.com/512/6062/6062646.png" class="tech-icon" style="bottom:10%; left:15%;">


<!-- üíß Form ƒëƒÉng k√Ω -->
<div class="register-container">
    <h2>ƒêƒÉng k√Ω t√†i kho·∫£n</h2>
    <form action="/register-post" method="post">
        <input type="text" name="name" placeholder="H·ªç v√† t√™n" required>
        <input type="email" name="email" placeholder="Email" required>
        <input type="text" name="phone" placeholder="S·ªë ƒëi·ªán tho·∫°i" required>
        <input type="password" name="password" placeholder="M·∫≠t kh·∫©u" required>
        <input type="password" name="confirmPassword" placeholder="X√°c nh·∫≠n m·∫≠t kh·∫©u" required>
        <button class="btn" type="submit">T·∫°o t√†i kho·∫£n</button>
    </form>
    
    <!-- Hi·ªÉn th·ªã th√¥ng b√°o l·ªói n·∫øu c√≥ -->
    <div th:if="${error}" class="alert alert-danger mt-3">
        <p style="color: red; text-align: center;" th:text="${error}"></p>
    </div>
    
    <!-- Hi·ªÉn th·ªã th√¥ng b√°o th√†nh c√¥ng n·∫øu c√≥ -->
    <div th:if="${success}" class="alert alert-success mt-3">
        <p style="color: green; text-align: center;" th:text="${success}"></p>
    </div>

    <!-- üü° ƒêƒÉng k√Ω b·∫±ng Google -->
    <button id="googleSignIn" type="button" class="google-btn">
        <img src="https://developers.google.com/identity/images/g-logo.png" alt="Google logo">
        ƒêƒÉng k√Ω b·∫±ng Google
    </button>

    <div class="options">
        <p>ƒê√£ c√≥ t√†i kho·∫£n? <a href="/login">ƒêƒÉng nh·∫≠p ngay</a></p>
    </div>
</div>

<!-- ‚ú® ƒê·ªëm tr·∫Øng theo chu·ªôt -->
<script>
    document.addEventListener("mousemove", (e) => {
        for (let i = 0; i < 3; i++) {
            const particle = document.createElement("div");
            particle.classList.add("particle");

            const x = e.pageX + (Math.random() * 20 - 10);
            const y = e.pageY + (Math.random() * 20 - 10);

            particle.style.left = x + "px";
            particle.style.top = y + "px";

            const size = Math.random() * 8 + 4;
            particle.style.width = size + "px";
            particle.style.height = size + "px";

            document.body.appendChild(particle);
            setTimeout(() => particle.remove(), 2000);
        }
    });
</script>

</body>
</html>