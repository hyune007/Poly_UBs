<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      th:replace="~{container/orders/order::view(~{::title}, ~{::article})}">
<head>
  <title>Trang ch·ªß</title>
</head>
<body>
<div th:replace="container/orders/order-process :: *"></div>
<article>
  <div class="container mb-5">
    <h3 class="text-center mt-4 mb-4">üõí Gi·ªè h√†ng c·ªßa b·∫°n</h3>

    <div class="row">
      <!-- Danh s√°ch s·∫£n ph·∫©m -->
      <div class="col-lg-8">
        <div class="cart-container">
          <div th:each="item : ${cartItems}" class="cart-item d-flex align-items-center mb-4 border-bottom pb-3">
            <img th:src="@{|/photos/${item.product.image}|}" style="height: 50px;width: 50px" alt="S·∫£n ph·∫©m">
            <div class="ms-3 flex-grow-1">
              <h6 class="mb-1" th:text="${item.product.name}"></h6>
              <small class="text-muted">
                Gi√°:
                <span th:text="${#numbers.formatDecimal(item.product.price,0,'COMMA',0,'POINT')}"></span>‚Ç´
              </small>
            </div>

            <!-- Form c·∫≠p nh·∫≠t s·ªë l∆∞·ª£ng -->
            <form action="/order/update-quantity" method="post" class="d-flex align-items-center me-3">
              <input type="hidden" name="productId" th:value="${item.product.id}">
              <input type="number"
                     name="quantity"
                     class="form-control form-control-sm me-2"
                     th:value="${item.quantity}"
                     min="1"
                     style="width:70px;"
                     onchange="this.form.submit()"> <!-- t·ª± ƒë·ªông submit khi ch·ªânh -->
            </form>

            <span class="fw-bold me-3"
                  th:text="${#numbers.formatDecimal(item.product.price * item.quantity,0,'COMMA',0,'POINT')} + '‚Ç´'"></span>

            <!-- N√∫t x√≥a -->
            <form action="/order/remove-from-cart" method="post">
              <input type="hidden" name="productId" th:value="${item.product.id}">
              <button type="submit" class="btn btn-sm btn-danger">X</button>
            </form>
          </div>
          </div>

          <a href="/home" class=" text-decoration-none">‚Üê Ti·∫øp t·ª•c mua h√†ng</a>
        </div>
      </div>

      <div class="col-lg-4">
        <div class="cart-summary">
          <h5 class="mb-3">T√≥m t·∫Øt ƒë∆°n h√†ng</h5>

          <div class="d-flex justify-content-between mb-2">
            <span>T·∫°m t√≠nh:</span>
            <strong th:text="${#numbers.formatDecimal(subtotal, 0, 'COMMA', 0, 'POINT')} + '‚Ç´'">0‚Ç´</strong>
          </div>

          <div class="d-flex justify-content-between mb-2">
            <span>Ph√≠ v·∫≠n chuy·ªÉn:</span>
            <strong th:text="${#numbers.formatDecimal(shippingFee, 0, 'COMMA', 0, 'POINT')} + '‚Ç´'">40.000‚Ç´</strong>
          </div>

          <hr>

          <div class="d-flex justify-content-between mb-3">
            <span><strong>T·ªïng c·ªông:</strong></span>
            <strong class="text-danger fs-5"
                    th:text="${#numbers.formatDecimal(total, 0, 'COMMA', 0, 'POINT')} + '‚Ç´'">0‚Ç´</strong>
          </div>

          <form action="/order/payment" method="get">
            <button type="submit" class="btn btn-primary w-100">Ti·∫øn h√†nh ƒë·∫∑t h√†ng</button>
          </form>
        </div>
      </div>
    </div>
    <div th:if="${error}" class="alert alert-danger" style="margin: 10px 0;">
      <span th:text="${error}"></span>
    </div>
  </div>
</article>
</body>
</html>

