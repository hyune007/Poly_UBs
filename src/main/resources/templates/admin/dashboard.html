<!DOCTYPE html>
<html lang="vi" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Admin Dashboard | Poly_UBs</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Th√™m Chart.js cho bi·ªÉu ƒë·ªì -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body {
            background-color: #f0f2f5;
            font-family: 'Segoe UI', sans-serif;
        }

        .sidebar {
            height: 100vh;
            background: #1e1f29;
            color: #fff;
            position: fixed;
            width: 260px;
            padding-top: 25px;
            box-shadow: 4px 0 10px rgba(0,0,0,0.2);
        }

        .sidebar h4 {
            letter-spacing: 1px;
        }

        .sidebar a {
            color: #d3d3d3;
            text-decoration: none;
            display: block;
            padding: 12px 22px;
            margin: 6px 12px;
            border-radius: 10px;
            transition: .25s;
            font-size: 15px;
        }

        .sidebar a:hover {
            background: #2c2d38;
            color: #4dabff;
        }

        .main-content {
            margin-left: 280px;
            padding: 25px;
        }

        .card {
            border: none;
            border-radius: 15px;
            transition: .3s;
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 20px rgba(0,0,0,0.15);
        }

        .summary-box {
            background: linear-gradient(135deg, #4dabff, #007bff);
            color: white;
            padding: 22px;
            border-radius: 15px;
            box-shadow: 0 5px 12px rgba(0,0,0,0.15);
            transition: .3s;
        }

        .summary-box:hover {
            transform: translateY(-4px);
        }

        .summary-icon {
            font-size: 40px;
            opacity: 0.8;
        }

        /* Style cho bi·ªÉu ƒë·ªì v√† b·∫£ng */
        .chart-container {
            background: white;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
            margin-bottom: 30px;
        }

        .table-responsive {
            background: white;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
        }

        .table th {
            background-color: #f8f9fa;
            border-top: none;
        }
    </style>
</head>
<body>
<div class="sidebar">
    <h4 class="text-center mb-4">Poly_UBs Admin</h4>
    <a th:href="@{/admin/dashboard}">üè† Trang ch·ªß</a>
    <a th:href="@{/admin/customer}">üë§ Qu·∫£n l√Ω kh√°ch h√†ng</a>
    <a th:href="@{/admin/employee}">üßë‚Äçüíº Qu·∫£n l√Ω nh√¢n vi√™n</a>
    <a th:href="@{/admin/products}">üì¶ Qu·∫£n l√Ω s·∫£n ph·∫©m</a>
    <a th:href="@{/admin/bills/manage}">üßæ Qu·∫£n l√Ω ƒë∆°n h√†ng</a>

    <hr class="text-secondary mx-3">
    <a th:href="@{/logout}">üö™ ƒêƒÉng xu·∫•t</a>
</div>

<div class="main-content">
    <div class="container">
        <h2 class="mb-3 fw-bold">B·∫£ng ƒëi·ªÅu khi·ªÉn qu·∫£n tr·ªã</h2>
        <p>Xin ch√†o, <strong th:text="${adminUser.name}"></strong> üëã</p>

        <!-- SUMMARY PANEL (ƒê√£ th√™m box T·ªïng doanh thu) -->
        <div class="row mt-4 g-4">
            <div class="col-lg-3 col-md-6">
                <div class="summary-box">
                    <div class="d-flex justify-content-between align-items-center">
                        <div>
                            <h5 class="mb-1">T·ªïng kh√°ch h√†ng</h5>
                            <h2 class="fw-bold" th:text="${totalCustomers}">0</h2>
                        </div>
                        <div class="summary-icon">üë§</div>
                    </div>
                </div>
            </div>

            <div class="col-lg-3 col-md-6">
                <div class="summary-box" style="background: linear-gradient(135deg, #ff9f43, #ff6f00);">
                    <div class="d-flex justify-content-between align-items-center">
                        <div>
                            <h5 class="mb-1">T·ªïng nh√¢n vi√™n</h5>
                            <h2 class="fw-bold" th:text="${totalEmployees}">0</h2>
                        </div>
                        <div class="summary-icon">üßë‚Äçüíº</div>
                    </div>
                </div>
            </div>

            <div class="col-lg-3 col-md-6">
                <div class="summary-box" style="background: linear-gradient(135deg, #6c5ce7, #341f97);">
                    <div class="d-flex justify-content-between align-items-center">
                        <div>
                            <h5 class="mb-1">T·ªïng s·∫£n ph·∫©m</h5>
                            <h2 class="fw-bold" th:text="${totalProducts}">0</h2>
                        </div>
                        <div class="summary-icon">üì¶</div>
                    </div>
                </div>
            </div>

            <div class="col-lg-3 col-md-6">
                <div class="summary-box" style="background: linear-gradient(135deg, #00b894, #00997a);">
                    <div class="d-flex justify-content-between align-items-center">
                        <div>
                            <h5 class="mb-1">T·ªïng ƒë∆°n h√†ng</h5>
                            <h2 class="fw-bold" th:text="${totalBills}">0</h2>
                        </div>
                        <div class="summary-icon">üßæ</div>
                    </div>
                </div>
            </div>

            <!-- Box m·ªõi: T·ªïng doanh thu -->
            <div class="col-lg-3 col-md-6">
                <div class="summary-box" style="background: linear-gradient(135deg, #e17055, #d63031);">
                    <div class="d-flex justify-content-between align-items-center">
                        <div>
                            <h5 class="mb-1">T·ªïng doanh thu</h5>
                            <h2 class="fw-bold" th:text="${totalRevenue}">0 VND</h2>
                        </div>
                        <div class="summary-icon">üí∞</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- CHARTS SECTION (Bi·ªÉu ƒë·ªì m·ªõi) -->
        <div class="row mt-5">
            <div class="col-md-6">
                <div class="chart-container">
                    <h5 class="mb-3">S·ªë l∆∞·ª£ng ƒë∆°n h√†ng theo th√°ng</h5>
                    <canvas id="ordersChart"></canvas>
                </div>
            </div>
            <div class="col-md-6">
                <div class="chart-container">
                    <h5 class="mb-3">Ph√¢n lo·∫°i s·∫£n ph·∫©m b√°n ch·∫°y</h5>
                    <canvas id="productsChart"></canvas>
                </div>
            </div>
        </div>

        <!-- TABLES SECTION (B·∫£ng m·ªõi) -->
        <div class="row mt-4">
            <div class="col-md-6">
                <div class="table-responsive">
                    <h5 class="mb-3">ƒê∆°n h√†ng g·∫ßn ƒë√¢y</h5>
                    <table class="table table-striped">
                        <thead>
                        <tr>
                            <th>ID</th>
                            <th>Kh√°ch h√†ng</th>
                            <th>T·ªïng ti·ªÅn</th>
                            <th>Tr·∫°ng th√°i</th>
                        </tr>
                        </thead>
                        <tbody>
                        <tr th:each="bill : ${recentBills}">
                            <td th:text="${bill.hdId}">1</td>
                            <td th:text="${bill.khachHang.khName}">Nguy·ªÖn VƒÉn A</td>
                            <td th:text="${bill.totalAmount}">500.000 VND</td>
                            <td th:text="${bill.hdStatus}">ƒê√£ giao</td>
                        </tr>
                        <!-- D·ªØ li·ªáu m·∫´u n·∫øu ch∆∞a c√≥ backend -->
                        <tr th:if="${recentBills == null or #lists.isEmpty(recentBills)}">
                            <td>1</td>
                            <td>Nguy·ªÖn VƒÉn A</td>
                            <td>500.000 VND</td>
                            <td>ƒê√£ giao</td>
                        </tr>
                        <tr th:if="${recentBills == null or #lists.isEmpty(recentBills)}">
                            <td>2</td>
                            <td>Tr·∫ßn Th·ªã B</td>
                            <td>750.000 VND</td>
                            <td>ƒêang x·ª≠ l√Ω</td>
                        </tr>
                        </tbody>
                    </table>
                </div>
            </div>
            <div class="col-md-6">
                <div class="table-responsive">
                    <h5 class="mb-3">S·∫£n ph·∫©m b√°n ch·∫°y nh·∫•t</h5>
                    <table class="table table-striped">
                        <thead>
                        <tr>
                            <th>T√™n s·∫£n ph·∫©m</th>
                            <th>S·ªë l∆∞·ª£ng b√°n</th>
                            <th>Doanh thu</th>
                        </tr>
                        </thead>
                        <tbody>
                        <tr th:each="product : ${topProducts}">
                            <td th:text="${product[0]}">S·∫£n ph·∫©m A</td>
                            <td th:text="${product[1]}">100</td>
                            <td th:text="${product[2]}">1.000.000 VND</td>
                        </tr>
                        <!-- D·ªØ li·ªáu m·∫´u n·∫øu ch∆∞a c√≥ backend -->
                        <tr th:if="${topProducts == null or #lists.isEmpty(topProducts)}">
                            <td>S·∫£n ph·∫©m A</td>
                            <td>100</td>
                            <td>1.000.000 VND</td>
                        </tr>
                        <tr th:if="${topProducts == null or #lists.isEmpty(topProducts)}">
                            <td>S·∫£n ph·∫©m B</td>
                            <td>80</td>
                            <td>800.000 VND</td>
                        </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- CARDS SECTION (Gi·ªØ nguy√™n) -->
        <div class="row mt-5 g-4">
            <div class="col-md-4">
                <div class="card shadow-sm">
                    <div class="card-body text-center">
                        <h5 class="card-title">Kh√°ch h√†ng</h5>
                        <p class="card-text text-muted">Xem v√† qu·∫£n l√Ω danh s√°ch kh√°ch h√†ng</p>
                        <a class="btn btn-primary" th:href="@{/admin/customer}">Qu·∫£n l√Ω</a>
                    </div>
                </div>
            </div>

            <div class="col-md-4">
                <div class="card shadow-sm">
                    <div class="card-body text-center">
                        <h5 class="card-title">Nh√¢n vi√™n</h5>
                        <p class="card-text text-muted">Qu·∫£n l√Ω th√¥ng tin v√† quy·ªÅn c·ªßa nh√¢n vi√™n</p>
                        <a class="btn btn-warning text-white" th:href="@{/admin/employee}">Qu·∫£n l√Ω</a>
                    </div>
                </div>
            </div>

            <div class="col-md-4">
                <div class="card shadow-sm">
                    <div class="card-body text-center">
                        <h5 class="card-title">S·∫£n ph·∫©m</h5>
                        <p class="card-text text-muted">Th√™m, s·ª≠a, x√≥a v√† xem s·∫£n ph·∫©m</p>
                        <a class="btn btn-success" th:href="@{/admin/products}">Qu·∫£n l√Ω</a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

<!-- JavaScript cho bi·ªÉu ƒë·ªì (v·ªõi d·ªØ li·ªáu ƒë·ªông t·ª´ backend) -->
<script>
    // Bi·ªÉu ƒë·ªì c·ªôt: S·ªë l∆∞·ª£ng ƒë∆°n h√†ng theo th√°ng
    const ordersData = /*[[${ordersByMonth}]]*/ [12, 19, 3, 5, 2, 3];  // D·ªØ li·ªáu t·ª´ backend (m·∫£ng s·ªë)
    const ordersCtx = document.getElementById('ordersChart').getContext('2d');
    new Chart(ordersCtx, {
        type: 'bar',
        data: {
            labels: ['Th√°ng 1', 'Th√°ng 2', 'Th√°ng 3', 'Th√°ng 4', 'Th√°ng 5', 'Th√°ng 6'],
            datasets: [{
                label: 'S·ªë ƒë∆°n h√†ng',
                data: ordersData,
                backgroundColor: 'rgba(75, 192, 192, 0.2)',
                borderColor: 'rgba(75, 192, 192, 1)',
                borderWidth: 1
            }]
        },
        options: {
            scales: {
                y: {
                    beginAtZero: true
                }
            }
        }
    });

    // Bi·ªÉu ƒë·ªì tr√≤n: Ph√¢n lo·∫°i s·∫£n ph·∫©m b√°n ch·∫°y
    const productsData = /*[[${productsByCategory}]]*/ [300, 50, 100, 80];  // D·ªØ li·ªáu t·ª´ backend (m·∫£ng s·ªë)
    const productsCtx = document.getElementById('productsChart').getContext('2d');
    new Chart(productsCtx, {
        type: 'pie',
        data: {
            labels: ['ƒêi·ªán t·ª≠', 'Qu·∫ßn √°o', 'Gia d·ª•ng', 'Kh√°c'],
            datasets: [{
                data: productsData,
                backgroundColor: ['#FF6384', '#36A2EB', '#FFCE56', '#4BC0C0']
            }]
        }
    });
</script>
</body>
</html>